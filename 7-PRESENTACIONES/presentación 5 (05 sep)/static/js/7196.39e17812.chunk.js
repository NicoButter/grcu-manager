"use strict";(self.webpackChunk_genially_view_client=self.webpackChunk_genially_view_client||[]).push([[7196],{43190:(e,t,i)=>{i.d(t,{q:()=>a});var n=i(45992),l=i(17588),s=i(66264),o=i(60708),d=i(34895),r=i(25e3);const a=e=>{let{getItems:t,item:i,menuType:a,theme:u,shouldCloseWhenClickOutside:c=!1,itemSize:m,menuTheme:h,styles:g}=e;const[v,f]=(0,l.useState)(t()),[p,S]=(0,l.useState)(!1),T=(0,l.useCallback)((()=>{S((e=>!e))}),[]);null===i||void 0===i||i.on(s.q.Message,(e=>{e===o.m.Entering&&(f(t()),S(!1))}));const y=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const n=t=>{i.current&&!i.current.contains(t.target)&&e(t)};return document.addEventListener("mouseup",n,t),document.addEventListener("touchend",n,t),()=>{document.removeEventListener("mouseup",n,t),document.removeEventListener("touchend",n,t)}}),[i,e,t]),i}((0,l.useCallback)((()=>{c&&p&&S(!1)}),[p,c]),!0);(0,l.useEffect)((()=>{f(t())}),[t]);const C=(0,d.CO)(a);return(0,r.T)({theme:u,children:(0,n.jsx)(C,{items:v,onToggleClick:T,opened:p,ref:y,theme:u,itemSize:m,menuTheme:h,styles:g})})}},27196:(e,t,i)=>{i.r(t),i.d(t,{geniallyMenuEditorScript:()=>k});var n=i(45992),l=i(17588),s=i(57277),o=i(42511);var d=i(43190),r=i(49443),a=i(34895),u=i(9380),c=i(15536),m=i(99678),h=i(45994),g=i(25e3);const v=(e,t,i,l,s)=>{const{width:d}=((e,t,i,l)=>{const s=(0,h.d)((0,g.T)({theme:t,children:(0,n.jsx)(o.W,{children:(0,n.jsx)(m.I,{items:e,menuTheme:i,styles:l})})}));return{width:s.width+2*c.I,height:s.height+2*c.I}})(t,i,l,s);return{itemsAreOverflowing:d>e,minimalWidth:d}};var f,p=i(47556);!function(e){e[e.MD=380]="MD"}(f||(f={}));const S=e=>e<=f.MD?u.L.Hamburger:u.L.Horizontal;var T=i(933);const y=new class{constructor(){this.state={}}getState(e){return this.state[e]}setState(e,t){this.state[e]=Object.assign(Object.assign({},this.state[e]),t)}removeState(e){delete this.state[e]}initializeState(e,t){this.state[e]=t}},C=e=>{var t,i;e.item&&e.item.exists&&y.setState(e.item.id,{menuType:e.getConfig().menuType,size:{width:null===(t=e.item)||void 0===t?void 0:t.width,height:null===(i=e.item)||void 0===i?void 0:i.height}})},w=(e,t)=>{let{item:i,editor:n,script:l}=e;if(!i)return;const s=y.getState(i.id);if(!s)return;const o=S(i.width),d=S(s.size.width),c=o!==d,m=i.width!==s.size.width,h=()=>v(i.width,(0,T.N)(l.getConfig().menuItems,n.t),n.theme,t,{backgroundColor:l.getConfig().backgroundColor}),g=e=>{((e,t,i,n)=>{e!==t.getConfig().menuType&&t.mutateConfig((t=>{t.menuType=e}));const l=(0,a.FB)(e);i.thumbnail!==l.dark&&i.thumbnail!==l.light&&(i.thumbnail=n===r.N.Dark?l.dark:l.light)})(e,l,i,t)};if(c){const{itemsAreOverflowing:e}=h();g(e?u.L.Hamburger:u.L.Horizontal)}else m&&(()=>{const{itemsAreOverflowing:e}=h();g(e?u.L.Hamburger:o)})();C(l)},b=(e,t)=>{var i;if(!e.item||!e.item.exists)return;const{item:n,getConfig:l}=e,s=n,{menuType:o,menuTheme:d}=l(),r=y.getState(e.item.id);if((e=>{let{currentWidth:t,previousWidth:i,currentMenuType:n,previousMenuType:l}=e;return t===i&&n!==l})({currentWidth:s.width,previousWidth:null===r||void 0===r?void 0:r.size.width,currentMenuType:o,previousMenuType:null===r||void 0===r?void 0:r.menuType})){if(o===u.L.Horizontal){const{minimalWidth:l}=v(n.width,(0,T.N)(e.getConfig().menuItems,t.t),t.theme,d,{backgroundColor:e.getConfig().backgroundColor}),r=(e=>{switch(e){case u.L.Horizontal:return{minWidth:f.MD,maxWidth:void 0};case u.L.Hamburger:return{minWidth:p.N_.width,maxWidth:f.MD};default:return{minWidth:void 0,maxWidth:void 0}}})(o),a=s.parentSlide.size.width-24,c=Math.min(l,a),m=Math.max(null!==(i=r.minWidth)&&void 0!==i?i:0,c);s.setSize(m,p.cE.height),s.setPosition((s.parentSlide.size.width-m)/2,s.y)}o===u.L.Hamburger&&s.setSize(p.N_.width,p.N_.height)}y.setState(e.item.id,{menuType:o,size:{width:null===s||void 0===s?void 0:s.width,height:null===s||void 0===s?void 0:s.height}})};var I=i(17901);const x=(e=>{const t=(e=>t=>{const{editor:i,script:s,isSelectableItem:d,selectableItems:r}=t,{selectedItem:a,selectedIndex:u,enableSelection:c,canSelectItem:m}=(0,o.C)();return(0,l.useEffect)((()=>{var e,t;if(!m)return void(null===(e=i.setToolbarOptions)||void 0===e||e.call(i,[]));if(!a||!d(a))return;const n=r.get(a);if(!n)return;const l=n.events.map((e=>({event:e.type})));null===(t=i.setToolbarOptions)||void 0===t||t.call(i,l);const o=i.on("toolbarOptionsChange",(e=>{let{option:t}=e;var i;null===(i=n.events.find((e=>e.type===t.event)))||void 0===i||i.handler({option:t,script:s,index:u})}));return()=>{null===o||void 0===o||o()}}),[i,s,a,u,m,d,r]),(0,l.useEffect)((()=>{const e=i.on("itemIsBeingEdited",(e=>{let{isBeingEdited:t}=e;c(t)}));return()=>{null===e||void 0===e||e()}}),[i,c]),(0,n.jsx)(e,Object.assign({},t))})(e);return e=>(0,n.jsx)(o.W,{isInEditor:!0,children:(0,n.jsx)(t,Object.assign({},e))})})((e=>{let{editor:t,script:i}=e;var s,o;const{theme:r,t:a}=t,{menuItems:u,menuType:c,menuTheme:m,backgroundColor:h}=i.getConfig(),{item:g}=i,v=(e=>e?{width:e.width}:{})(g);(0,l.useEffect)((()=>{w({item:g,editor:t,script:i},m)}),[t,g,m,v,i]);const f={width:null!==(s=null===g||void 0===g?void 0:g.width)&&void 0!==s?s:0,height:null!==(o=null===g||void 0===g?void 0:g.height)&&void 0!==o?o:0};return(0,n.jsx)(d.q,{getItems:()=>(0,T.N)(u,a),menuType:c,theme:r,itemSize:f,menuTheme:m,styles:{backgroundColor:h}})})),k=e=>{let{script:t,editor:i}=e;i.on("slideCreated",(e=>{let{slide:i}=e;((e,t)=>{!1===e.getConfig().slidesToDisplay.allSlidesSelected&&e.item.excludedSlidesIds.push(t.id)})(t,i)})),i.on("slideDeleted",(e=>{let{slide:n}=e;((e,t)=>{1===e.getSlides().length&&t.mutateConfig((e=>{e.slidesToDisplay.allSlidesSelected=!0,e.slidesToDisplay.selectedSlides=[]}))})(i,t),((e,t)=>{const{allSlidesSelected:i,selectedSlides:n}=e.getConfig().slidesToDisplay;if(!i)if(null===n||void 0===n?void 0:n.includes(t.id))e.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=e.slidesToDisplay.selectedSlides.filter((e=>e!==t.id))}));else{const i=e.item;i.excludedSlidesIds=i.excludedSlidesIds.filter((e=>e!==t.id))}})(t,n)})),t.once("configChange",(()=>{C(t),(e=>{let{editor:t,script:i}=e;0===i.getConfig().slidesToDisplay.selectedSlides.length&&i.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=t.getSlides().map((e=>e.id))}))})({editor:i,script:t})})),t.on("configChange",(e=>{let{config:n,prevConfig:l}=e;((e,t,i,n)=>{e.item&&e.item.exists&&(function(e){const{item:t}=e,i=t;i.isTransversal||(i.isTransversal=!0)}(e),function(e,t,i){const n=i.slidesToDisplay.selectedSlides.filter((e=>t.getSlides().find((t=>t.id===e))));n.length!==i.slidesToDisplay.selectedSlides.length&&e.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=n}))}(e,t,i),function(e,t,i,n){const{item:l}=e,s=l;(i.slidesToDisplay.allSlidesSelected!==(null===n||void 0===n?void 0:n.slidesToDisplay.allSlidesSelected)||i.slidesToDisplay.selectedSlides!==(null===n||void 0===n?void 0:n.slidesToDisplay.selectedSlides))&&(s.excludedSlidesIds=function(e,t){if(e.slidesToDisplay.allSlidesSelected)return[];const i=t.getSlides(),n=e.slidesToDisplay.selectedSlides||[];return i.filter((e=>!n.includes(e.id))).map((e=>e.id))}(i,t),e.mutateConfig((e=>{e.slidesToDisplay.allSlidesSelected&&(e.slidesToDisplay.selectedSlides=[])})))}(e,t,i,n))})(t,i,n,l),(e=>{if(!e.item||!e.item.exists)return;const{item:t,getConfig:i}=e,n=t,{menuType:l,menuTheme:s}=i(),o=y.getState(e.item.id),d=(0,a.FB)(l);(null===o||void 0===o?void 0:o.menuType)===l&&(null===o||void 0===o?void 0:o.menuTheme)===s||(n.thumbnail=s===r.N.Dark?d.dark:d.light)})(t),b(t,i);const{item:s}=t;s&&"showOverflow"in s&&!s.showOverflow&&(s.showOverflow=!0)})),t.on("dispose",(()=>{var e,i,n;(null===(e=null===t||void 0===t?void 0:t.item)||void 0===e?void 0:e.id)&&(null===(n=null===(i=y.getState(t.item.id))||void 0===i?void 0:i.disposer)||void 0===n||n.call(i),y.removeState(t.item.id))})),(0,s.x)({getTargetNodeItem:()=>t.item,renderApp:()=>(0,n.jsx)(x,{editor:i,script:t,isSelectableItem:I.M2,selectableItems:I.Xg}),nodePrefix:"menu"})({script:t,editor:i})}},933:(e,t,i)=>{i.d(t,{N:()=>s,e:()=>d});var n=i(48237);const l=(e,t)=>""===e?t("__new.view.widget.menu.sidebar.emptyTitlePlaceholder"):e,s=(e,t)=>e.map(((e,i)=>{var s;const o=(null===(s=e.menuItemAction.action)||void 0===s?void 0:s.type)===n.L.GoToSlide;return{text:l(e.menuItemName,t),key:i,onClick:()=>{},isLink:o,isActive:!1,isAllowed:o,altText:e.altText,backgroundColor:e.backgroundColor}})),o={active:!1,allowed:!1},d=(e,t)=>e.map(((e,i)=>{var s,d;const r=!!(null===(s=e.menuItemAction)||void 0===s?void 0:s.data)&&(null===(a=e.menuItemAction.data)||void 0===a?void 0:a.type)===n.L.GoToSlide;var a;const{active:u,allowed:c}=r&&(null===(d=e.menuItemAction)||void 0===d?void 0:d.data)?t.getGoToSlideState(e.menuItemAction.data):o;return{text:l(e.menuItemName,t.t),key:i,onClick:()=>{var t;return null===(t=e.menuItemAction)||void 0===t?void 0:t.run()},isLink:r,isActive:u,isAllowed:c,altText:e.altText}}))},57277:(e,t,i)=>{i.d(t,{x:()=>l});var n=i(70377);function l(e){let{getTargetNodeItem:t,renderApp:i,renderThumbnailApp:l,nodePrefix:s}=e;return e=>{let{script:o,editor:d}=e,r=null,a=[];function u(e){r&&(n.unmountComponentAtNode(r),r=null),e&&"innerHtml"in e&&(e.innerHtml='<div class="card-iframe"><div style="width: 100%; height: 100%; background: #FF0000; color: #FFFFFF;">Deleted</div><script><\/script></div>')}function c(){r&&n.render(i(),r)}function m(){const e=t(o.getConfig());if(!e)return;const i=`${s}-${e.id}`;"innerHtml"in e&&(e.innerHtml=`<div class="card-iframe"><div id="${i}" class="genially-widget-app" style="width: 100%; height: 100%;"></div></div>`),requestAnimationFrame((()=>{r="idOfFreeNode"in e?document.getElementById(e.idOfFreeNode)||null:document.getElementById(i)||null,c()}))}function h(){l&&a.length&&a.forEach((e=>{n.render(l(),e)}))}function g(){const e=t(o.getConfig());e&&"idOfThumbnailFreeNode"in e&&requestAnimationFrame((()=>{const t=document.getElementsByClassName(e.idOfThumbnailFreeNode);a=Array.from(t),h()}))}o.on("configChange",(e=>{let{config:i,prevConfig:n}=e;const l=t(i),s=n?t(n):void 0;s&&s!==l&&u(s),l&&(l!==s?(m(),g()):(c(),h()))})),o.on("dispose",(()=>{u(t(o.getConfig()))})),d.on("itemMount",(e=>{let{item:t}=e;t===o.item&&m()})),d.on("itemUnmount",(e=>{let{item:t}=e;t===o.item&&u()})),d.on("itemThumbnailMount",(e=>{let{item:t}=e;t===o.item&&g()}))}}}}]);
//# sourceMappingURL=https://s3-static-genially.genially.com/view/static/js/7196.39e17812.chunk.js.map